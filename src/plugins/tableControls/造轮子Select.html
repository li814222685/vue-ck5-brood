<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select</title>
    <style>
        /* Select æœ€å¤–å±‚å®¹å™¨ */
        .v_select {
            /* äº‹å®ä¸ŠSelect çš„å®½é«˜åº”è¯¥æ˜¯è‡ªé€‚åº”çš„ï¼Œæ”¯æŒå¤–éƒ¨å‚æ•°æ¥æ”¹å˜ Select å¯¹åº”çš„å®½é«˜ */
            width: 500px;
            height: 30px;
            margin: 0 auto;
            margin-top: 20vh;
        }

        /* Select çš„é€‰æ‹©æ¡† */
        .v_select_dropDown {
            position: relative;

        }

        /* å¯è¾“å…¥ é€‰æ‹©æ¡†æ–‡å­—éƒ¨åˆ†  */
        .v_select_dropDown_text {
            display: block;
            padding: 0 10px;
            line-height: 38px;
            border-bottom: 1px solid #d8d7d9;
            border-radius: 4px;
            font-size: 16px;
            color: #333;
            background: #fff;
        }

        /* æ‰“å¼€Optionåˆ—è¡¨ é€‰æ‹©æ¡†é€‰ä¸­åçš„æ ·å¼ */
        .v_select_dropDown_text_sele {

            display: block;
            padding: 0 10px;
            line-height: 38px;
            /* border: 1px solid #1769fe; */
            border: 1px solid rgba(218, 130, 36, 0.437);

            border-radius: 4px;
            font-size: 16px;
            /* color: #1968ff; */
            /* background: #dce9ff; */
            background: rgba(255, 169, 77, 0.2);

        }

        /* ä¿®æ”¹ContentEditable çš„é»˜è®¤Style */
        [contenteditable] {
            outline: 1px solid transparent;
        }

        [contenteditable]:focus {
            border-bottom: 3px solid rgba(191, 111, 26, 0.437);
            border-radius: 3px;
        }



        /*Select ç®­å¤´çš„æ ·å¼  */
        .triangle_up {
            width: 0;
            height: 0;
            right: 20px;
            top: 17px;
            position: absolute;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #323232;

        }

        .triangle_down {
            width: 0;
            height: 0;
            right: 20px;
            top: 17px;
            position: absolute;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid rgba(235, 142, 42, 0.437);
            transform: rotate(180deg);
            transition: transform 0.2s linear;
        }

        /* Option åˆ—è¡¨   */

        .v_select_optionList {
            border: 1px solid rgba(218, 130, 36, 0.437);
            border-top: none;
            display: none;
            border-radius: 4px;
            position: absolute;
            z-index: 999;
        }

        .v_select_optionList_item {
            padding: 5px;
        }

        .v_select_optionList_item:hover {
            background-color: rgba(255, 169, 77, 0.2);

        }

        .hidden_item {
            display: none;
        }
    </style>
</head>

<body>
    <div class="v_select" onclick="onClickSelect()">
        <div style="border: 1px solid;">
                    <div class="v_select_dropDown">
            <div id="v_select_dropDown_text" class="v_select_dropDown_text" contenteditable="true">è‡ªå®šä¹‰è‡ªå®šä¹‰
            </div>
            <span id="theme_icon" class="triangle_up" contenteditable="false"></span>


        </div>
        <div class="v_select_optionList">
            <div class="v_select_optionList_item" data-value="æœé˜³åŒº" onclick="clickOption();">æœé˜³åŒº</div>
            <div class="v_select_optionList_item" data-value="æµ·æ·€åŒº" onclick="clickOption();">æµ·æ·€åŒº</div>
            <div class="v_select_optionList_item" data-value="è¥¿åŸåŒº" onclick="clickOption();">è¥¿åŸåŒº</div>
            <div class="v_select_optionList_item" data-value="é€šå·åŒº" onclick="clickOption();">é€šå·åŒº</div>

        </div>
        </div>

        <script>
            const V_SELECT = "v_select"
            const V_SELECT_DROPDOWN_TEXT="v_select_dropDown_text"
            const V_SELECT_DROPDOWN_TEXT_SELE ="v_select_dropDown_text_sele"

            const TRIANGlE_DOWN = "triangle_down"
            const TRIANGlE_UP = "triangle_up"

            const DATA_VALUE = "data-value"
            const HIDDEN_ITEM = "hidden_item"

            /** Selectçš„ç‚¹å‡»äº‹ä»¶*/
            const onClickSelect = () => {
                if (document.querySelector(".v_select_dropDown_text_sele")) return
                document.querySelector('.v_select_optionList').style.display = "block"
                document.querySelector(".v_select_dropDown_text").className = V_SELECT_DROPDOWN_TEXT_SELE;
                document.getElementById("theme_icon").className = TRIANGlE_DOWN;
              const selectWidth =   document.querySelector('.v_select')?.offsetWidth
              
              console.log('%cğŸ‰Lee%cline:155%cselectWidth', 'color:#fff;background:#ee6f57;padding:3px;border-radius:2px', 'color:#fff;background:#1f3c88;padding:3px;border-radius:2px', 'color:#fff;background:rgb(114, 83, 52);padding:3px;border-radius:2px', selectWidth)
                              document.querySelector('.v_select_optionList').style.width = selectWidth+'px'              
            }

            /** Optionçš„ç‚¹å‡»äº‹ä»¶*/
            const clickOption = () => {
                var t_obj = event.target;
                console.log(t_obj.getAttribute(DATA_VALUE)); //å¯è·å–è‡ªå®šä¹‰å±æ€§å€¼
                document.getElementById(V_SELECT_DROPDOWN_TEXT).innerHTML = t_obj.getAttribute(DATA_VALUE);
            }

            /** Select å¤±ç„¦çš„é€»è¾‘ï¼Œå¤±ç„¦åå»éšè—OptionList*/
            document.onclick = function () {
                var cur_obj = event.target;
                console.log(cur_obj.className)
                if ( V_SELECT_DROPDOWN_TEXT!= cur_obj.className && V_SELECT != cur_obj.className && V_SELECT_DROPDOWN_TEXT_SELE != cur_obj.className) {
                    document.querySelector(".v_select_optionList").style.display = "none";
                    document.getElementById(V_SELECT_DROPDOWN_TEXT).className = V_SELECT_DROPDOWN_TEXT;
                    document.getElementById("theme_icon").className = TRIANGlE_UP;
                }
            };

            /** Select ContentEditable çš„onChange å’Œ Select çš„æœç´¢åŠŸèƒ½*/
            document.getElementById(V_SELECT_DROPDOWN_TEXT).addEventListener("input", (e) => {
                console.log("è¾“å…¥äº†ä¸œè¥¿ï¼", e.target.innerHTML)
                //select valueçš„onchange ä»¥åŠ value å¯¹ optionåˆ—è¡¨çš„æœç´¢åŒ¹é…åŠŸèƒ½
                const value = e.target.innerHTML
                // 1.è¿‡æ»¤æ‰Option åˆ—è¡¨å†…æ‰€æœ‰æœªå‘½ä¸­ keyWord çš„option
                const optionContainer = document.querySelector('.v_select_optionList')
                const originOptions = document.querySelectorAll(".v_select_optionList_item")
                const _options = [...originOptions].forEach(opt => {
                    //optionæ˜¯å¦åŒ…å«å…³é”®å­—
                    const isIncludes = opt.innerHTML.includes(value)
                    //option æ˜¯å¦éšè—
                    const isHidden = opt.className.includes(HIDDEN_ITEM)
                    if (!isIncludes && !opt.className.includes(HIDDEN_ITEM)) {
                        opt.className += " hidden_item"
                    } else if (isIncludes) {
                        opt.className = opt.className.replace(HIDDEN_ITEM, "")
                    } 

                })
            })
        </script>

</body>

</html>